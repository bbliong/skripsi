define(["../my-app.js"],function(_myApp){"use strict";function _templateObject_89ea18a0da2b11e9886ab5694315db4a(){var data=babelHelpers.taggedTemplateLiteral(["\n      <style include=\"shared-styles\">\n        :host {\n          display: block;\n\n          padding: 10px;\n        }\n        #main-table, #sub-table { \n          border-collapse: collapse;\n          border: 1px solid #ddd;\n          text-align: left;\n          width :100%;\n        }\n\n        #main-table > tbody > tr > th{\n          width : 20%;\n          padding : 8px;\n        }\n\n        \n        #sub-table > tbody > tr > td:first-child{\n          width : 30%;\n          padding : 8px;\n        }\n\n\n        tr:nth-child(even) {background-color: #f2f2f2;}\n\n        vaadin-text-area {\n          max-height: 300px;\n          width: 90%;\n          margin : 1px 20px\n        }\n\n        vaadin-text-field{\n          width : 90%;\n          margin : 2px 4px;\n        }\n\n        @media all and (max-width: 700px){\n          .card {\n            display :table;\n          }\n\n          .card > table {\n            display :table-row;\n          }\n        }\n\n        \n      </style>\n         <!-- app-location binds to the app's URL -->\n         <app-location route=\"{{route}}\"></app-location>\n\n        <!-- this app-route manages the top-level routes -->\n        <app-route\n            route=\"{{route}}\"\n            pattern=\"/panel/proposal/edit-upd/:kat/:id\"\n            data=\"{{routeData}}\"\n            tail=\"{{subroute}}\"></app-route>\n\n        <global-variable key=\"LoginCred\" value=\"{{ storedUser }}\"></global-variable>\n        <global-variable key=\"error\" value=\"{{ error }}\"></global-variable>\n        <global-variable key=\"toast\" value=\"{{ toast }}\"></global-variable>\n        <global-data id=\"globalData\"></global-data>\n        \n      <div class=\"card\">\n      <vaadin-dialog aria-label=\"polymer templates\" id=\"dialog_manager\">\n          <template>\n          <h4>Ingin mencetak UPD?</h4>\n            <vaadin-button on-click=\"cetak\"> Cetak</vaadin-button>\n            <vaadin-button on-click=\"cancel\"  theme=\"error primary\"> Tidak</vaadin-button>\n          </template>\n        </vaadin-dialog>\n        \n        <vaadin-dialog aria-label=\"polymer templates\" id=\"dialog_kadiv\" >\n          <template>\n            <div style=\"text-align:center\">\n            <h3>Apakah bapak/ibu menyetujui UPD ini ?</h3>\n            <vaadin-text-area placeholder=\"Keterangan\" value=\"{{regObj.persetujuan.keterangan_kadiv}}\" ></vaadin-text-area>\n            <vaadin-button on-click=\"setuju\"  theme=\"success primary\"> Setuju</vaadin-button>\n            <vaadin-button on-click=\"tidakSetuju\"  theme=\"error primary\"> Tidak Setuju</vaadin-button>\n           </div>\n          </template>\n        </vaadin-dialog>\n        <h1>UPD Edit</h1>\n        <table border=\"2\" id=\"main-table\">\n            <tbody>\n                <tr>\n                  <th>\n                  Tujuan<br>\n                  <paper-icon-button icon =\"add\" class=\"green\" data-id=\"tujuan\" on-click=\"_addField\"></paper-icon-button>\n                  <paper-icon-button icon=\"remove\" data-id=\"tujuan\" on-click=\"_removeField\">   </paper-icon-button>\n                  </th>\n                  <td>\n                      <dom-repeat items=\"{{Upd.tujuan}}\" id=\"tujuan_isi\">\n                          <template>\n                               <vaadin-text-area label=\"Tujuan {{displayIndex(index)}}\" value=\"{{item}}\" ></vaadin-text-area>\n                          </template>\n                      </dom-repeat>\n                  </td>\n                </tr>\n                <tr>\n                  <th>Latar Belakang<br>\n                  <paper-icon-button icon =\"add\" class=\"green\" data-id=\"latar_belakang\" on-click=\"_addField\"></paper-icon-button>\n                  <paper-icon-button icon=\"remove\" data-id=\"latar_belakang\" on-click=\"_removeField\">   </paper-icon-button></th>\n                  <td>\n                      <dom-repeat items=\"{{Upd.latar_belakang}}\" id=\"latar_belakang_isi\">\n                          <template>\n                               <vaadin-text-area label=\"Latar Belakang {{displayIndex(index)}}\" value=\"{{item}}\" ></vaadin-text-area>\n                          </template>\n                      </dom-repeat>\n                  </td>\n                </tr>\n                <tr>\n                  <th>Analisis Kelayakan<br>\n                  <paper-icon-button icon =\"add\" class=\"green\" data-id=\"analisis_kelayakan\" on-click=\"_addField\"></paper-icon-button>\n                  <paper-icon-button icon=\"remove\" data-id=\"analisis_kelayakan\" on-click=\"_removeField\">   </paper-icon-button></th>\n                  <td>\n                      <dom-repeat items=\"{{Upd.analisis_kelayakan}}\" id=\"analisis_kelayakan_isi\">\n                          <template>\n                               <vaadin-text-area label=\"Analisis Kelayakan {{displayIndex(index)}}\" value=\"{{item}}\" ></vaadin-text-area>\n                          </template>\n                      </dom-repeat>\n                  </td>\n                </tr>\n                <tr>\n                  <th>Program Penyaluran</th>\n                  <td>\n                      <table border=\"2\" id=\"sub-table\">\n                          <tr>\n                              <td>Nominal Bantuan</td>\n                              <td> <vaadin-text-field  value=\"{{regObj.kategoris.jumlah_bantuan}}\"></vaadin-text-field></td>\n                          </tr>\n                          <tr>\n                              <td>Biaya Diserahkan</td>\n                              <td> <vaadin-text-field  disabled value=\"{{regObj.verifikasi.bentuk_bantuan}}\"></vaadin-text-field></td>\n                          </tr>\n                          <tr>\n                              <td>Pelaksana Teknis Kegiatan</td>\n                              <td> <vaadin-text-field value=\"{{Upd.program_penyaluran.pelaksana_teknis}}\"></vaadin-text-field></td>\n                          </tr>\n                          <tr>\n                              <td>Biaya diberikan melalui rekening</td>\n                              <td> <vaadin-text-field value=\"{{Upd.program_penyaluran.alur_biaya}}\"></vaadin-text-field></td>\n                          </tr>\n                          <tr>\n                              <td>Penanggung jawab laporan kegiatan</td>\n                              <td> <vaadin-text-field value=\"{{Upd.program_penyaluran.penanggung_jawab}}\"></vaadin-text-field></td>\n                          </tr>\n                      </table>\n\n                  </td>\n                </tr>\n                <tr>\n                  <th>Rekomendaasi<br>\n                  <paper-icon-button icon =\"add\" class=\"green\" data-id=\"rekomendasi\" on-click=\"_addField\"></paper-icon-button>\n                  <paper-icon-button icon=\"remove\" data-id=\"rekomendasi\" on-click=\"_removeField\">   </paper-icon-button></th>\n                  <td>\n                  <dom-repeat items=\"{{Upd.rekomendasi}}\" id=\"rekomendasi_isi\">\n                          <template>\n                               <vaadin-text-area label=\"Rekomendasi {{displayIndex(index)}}\" value=\"{{item}}\" ></vaadin-text-area>\n                          </template>\n                      </dom-repeat>\n                  </td>\n                </tr>\n                <tr>\n                    <th>Status Verifikasi</th> \n                    <td>\n                        <p> Verifikator : {{ tanggalPenting.verifikasi }} oleh <b>{{ regObj.verifikasi.nama_pelaksana }}</b>  </p>\n                        <p> Pembuatan UPD : {{ tanggalPenting.verifikator }}  oleh <b>{{regObj.persetujuan.verifikator_nama }}</b> </p>\n                        <p> Manager : {{ tanggalPenting.manager }}   oleh <b>{{ regObj.persetujuan.manager_nama }}  </b></p>\n                        <p> Kadiv / Direktur Eksekutif : {{ tanggalPenting.kadiv }} oleh <b>{{ regObj.persetujuan.kadiv_nama }} </b> </p>\n\n                    </td> \n\n                </tr>\n            </tbody>\n        </table>\n        <div class=\"tombol\">\n        <paper-button  raised class=\"indigo\" on-click=\"printData\" id=\"cetak_upd\">Cetak UPD</paper-button>\n\n        <paper-button  raised class=\"indigo\" on-click=\"sendData\" id=\"simpan_dan_cetak_upd\">Simpan dan Cetak UPD</paper-button>\n\n         <paper-button  raised class=\"indigo\" on-click=\"periksaUPD\" id=\"approve\">Periksa UPD</paper-button>\n\n         <paper-button  raised class=\"indigo\" on-click=\"setujuiUPD\" id=\"approveKadiv\">Setujui UPD</paper-button>\n\n        </div>\n      </div>\n      <iron-ajax \n          auto\n          id=\"getData\"\n          headers='{\"Access-Control-Allow-Origin\": \"*\" }'\n          handle-as=\"json\"\n          method=\"GET\"\n          on-response=\"_handleProposal\"\n          on-error=\"_handleProposalError\"\n          Content-Type=\"application/json\"\n          debounce-duration=\"300\">\n      </iron-ajax>\n\n      <iron-ajax \n          id=\"printData\"\n          headers='{\"Access-Control-Allow-Origin\": \"*\" }'\n          method=\"GET\"\n          handle-as=\"json\"\n          method=\"GET\"\n          on-response=\"_handleUPD\"\n          on-error=\"_handleUPDError\"\n          Content-Type=\"application/json\"\n          debounce-duration=\"300\">\n      </iron-ajax>\n\n      <iron-ajax \n          id=\"postData\"\n          headers='{\"Access-Control-Allow-Origin\": \"*\" }'\n          handle-as=\"json\"\n          method=\"PUT\"\n          on-response=\"_handleProposalPost\"\n          on-error=\"_handleProposalPostError\"\n          Content-Type=\"application/json\"\n          debounce-duration=\"300\">\n      </iron-ajax>\n\n      <div class=\"toast\">\n         <paper-toast text=\"{{toastError}}\" id=\"toastError\" ></paper-toast>\n      </div>\n\n\n    "]);_templateObject_89ea18a0da2b11e9886ab5694315db4a=function _templateObject_89ea18a0da2b11e9886ab5694315db4a(){return data};return data}var UpdEdit=function(_PolymerElement){babelHelpers.inherits(UpdEdit,_PolymerElement);function UpdEdit(){babelHelpers.classCallCheck(this,UpdEdit);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(UpdEdit).apply(this,arguments))}babelHelpers.createClass(UpdEdit,[{key:"_changeStoI",value:function _changeStoI(f){var array=f.path.split(".");if("jumlah_bantuan"==array[2]){f.base[array[2]]=parseInt(f.value)}}},{key:"displayIndex",value:function displayIndex(index){return index+1}},{key:"_addField",value:function _addField(obj){var id=obj.target.getAttribute("data-id");this.Upd[id].push(" ");this.shadowRoot.querySelector("#"+id+"_isi").render()}},{key:"_removeField",value:function _removeField(obj){var id=obj.target.getAttribute("data-id"),count=this.Upd[id].length;if(1<count){this.Upd[id].splice(count-1,1);this.shadowRoot.querySelector("#"+id+"_isi").render()}}},{key:"_handleProposal",value:function _handleProposal(e){this.regObj=e.detail.response.Data;var verifikator="Belum buat UPD",manager="Belum diperiksa Manager",kadiv="Belum disetujui Kadiv",verifikasi="Belum diverifikasi";if("undefined"!=typeof this.regObj.verifikasi.tanggal_verifikasi){verifikasi=this.formatDate(new Date(this.regObj.verifikasi.tanggal_verifikasi))}if("undefined"!=typeof this.regObj.persetujuan.verifikator_tanggal){verifikator=this.formatDate(new Date(this.regObj.persetujuan.verifikator_tanggal))}if("undefined"!=typeof this.regObj.persetujuan.manager_tanggal){manager=this.formatDate(new Date(this.regObj.persetujuan.manager_tanggal))}if("undefined"!=typeof this.regObj.persetujuan.kadiv_tanggal){if(0==this.regObj.persetujuan.status_persetujuan_kadiv){kadiv="Tidak disetujui pada tanggal "}else{kadiv="Disetujui pada hari "}kadiv+=this.formatDate(new Date(this.regObj.persetujuan.kadiv_tanggal))}this.tanggalPenting={verifikasi:verifikasi,verifikator:verifikator,manager:manager,kadiv:kadiv};if("undefined"!==typeof this.regObj.upd){this.Upd=this.regObj.upd;if("undefined"==typeof this.Upd.url){this.shadowRoot.querySelector("#cetak_upd").style.display="none"}else{this.shadowRoot.querySelector("#cetak_upd").style.display="inline-block"}}else{this.shadowRoot.querySelector("#cetak_upd").style.display="none";this.Upd={tujuan:[""],latar_belakang:[""],analisis_kelayakan:[""],program_penyaluran:{pelaksana_teknis:"",alur_biaya:"",penanggung_jawab:""},rekomendasi:[""],url:""}}if(9==this.storedUser.role){if("undefined"==typeof this.regObj.persetujuan.keterangan_kadiv){this.regObj.persetujuan.keterangan_kadiv=""}}}},{key:"_handleProposalError",value:function _handleProposalError(e){this.error=e.detail.request.xhr.status;this.set("route.path","/panel/proposal")}},{key:"_routePageChanged",value:function _routePageChanged(page){switch(this.storedUser.role){case 1:case 2:this.shadowRoot.querySelector("#approve").style.display="none";this.shadowRoot.querySelector("#approveKadiv").style.display="none";break;case 3:this.shadowRoot.querySelector("#simpan_dan_cetak_upd").style.display="none";this.shadowRoot.querySelector("#approveKadiv").style.display="none";break;case 4:this.shadowRoot.querySelector("#approve").style.display="none";this.shadowRoot.querySelector("#simpan_dan_cetak_upd").style.display="none";break;case 9:this.shadowRoot.querySelector("#approve").style.display="none";this.shadowRoot.querySelector("#simpan_dan_cetak_upd").style.display="none";break;}this.$.getData.url=MyAppGlobals.apiPath+"/api/pendaftaran/"+this.routeData.kat+"/"+this.routeData.id;this.$.getData.headers.authorization=this.storedUser.access_token}},{key:"_handleProposalPost",value:function _handleProposalPost(e){this.shadowRoot.querySelector("#dialog_manager").opened=!0}},{key:"_handleProposalPostError",value:function _handleProposalPostError(e){this.error=e.detail.request.xhr.status;this.set("route.path","/panel/proposal")}},{key:"sendData",value:function sendData(){this.regObj.upd=this.Upd;this.$.postData.url=MyAppGlobals.apiPath+"/api/upd/"+this.routeData.id;this.$.postData.headers.authorization=this.storedUser.access_token;this.$.postData.body=this.regObj;this.$.postData.generateRequest()}},{key:"_handleUPD",value:function _handleUPD(e){if("undefined"!==typeof e.detail.response.url){document.location.href=MyAppGlobals.apiPath+e.detail.response.url;this.set("route.path","/panel/proposal")}}},{key:"printData",value:function printData(){this.$.printData.url=MyAppGlobals.apiPath+"/api/report/upd/"+this.routeData.kat+"/"+this.routeData.id;this.$.printData.headers.authorization=this.storedUser.access_token;this.$.printData.generateRequest()}},{key:"periksaUPD",value:function periksaUPD(){this.regObj.upd=this.Upd;this.$.postData.url=MyAppGlobals.apiPath+"/api/upd/"+this.routeData.id;this.$.postData.headers.authorization=this.storedUser.access_token;this.$.postData.body=this.regObj;this.$.postData.generateRequest()}},{key:"setujuiUPD",value:function setujuiUPD(){this.shadowRoot.querySelector("#dialog_kadiv").opened=!0}},{key:"formatDate",value:function formatDate(date){var hari=["Minggu","Senin","Selasa","Rabu","Kamis","Jum'at","Sabtu"],bulan=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],day=date.getDay(),dd=date.getDate(),mm=date.getMonth(),yyyy=date.getFullYear(),hari=hari[day],bulan=bulan[mm];return hari+","+dd+" "+bulan+" "+yyyy}},{key:"cetak",value:function cetak(){this.toast="Berhasil Menyimpan UPD";this.shadowRoot.querySelector("#dialog_manager").opened=!1;this.printData()}},{key:"cancel",value:function cancel(){this.toast="Berhasil Menyimpan UPD";this.shadowRoot.querySelector("#dialog_manager").opened=!1;this.set("route.path","/panel/proposal")}},{key:"setuju",value:function setuju(){this.regObj.persetujuan.status_persetujuan_kadiv=1;this.periksaUPD();this.shadowRoot.querySelector("#dialog_kadiv").opened=!1}},{key:"tidakSetuju",value:function tidakSetuju(){this.regObj.persetujuan.status_persetujuan_kadiv=0;this.periksaUPD();this.shadowRoot.querySelector("#dialog_kadiv").opened=!1}}],[{key:"template",get:function get(){return(0,_myApp.html)(_templateObject_89ea18a0da2b11e9886ab5694315db4a())}},{key:"properties",get:function get(){return{Upd:{type:Object,notify:!0,value:function value(){return{tujuan:[" "],latar_belakang:[" "],analisis_kelayakan:[" "],program_penyaluran:{pelaksana_teknis:"",alur_biaya:"",penanggung_jawab:""},rekomendasi:[""],url:""}},storedUser:{type:Object,notify:!0},regObj:{type:Object,notify:!0,value:function value(){return{}}},tanggalPenting:{type:Object,notify:!0,value:function value(){return{}}}}}}},{key:"observers",get:function get(){return["_changeStoI(regObj.kategoris.*)","_routePageChanged(routeData.*)"]}}]);return UpdEdit}(_myApp.PolymerElement);window.customElements.define("bmm-upd-edit",UpdEdit)});