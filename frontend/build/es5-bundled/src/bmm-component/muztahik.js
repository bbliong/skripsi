define(["require","../my-app.js"],function(_require,_myApp){"use strict";_require=babelHelpers.interopRequireWildcard(_require);function _templateObject_39736430a3c111e9ab8d3bc52ff0ef99(){var data=babelHelpers.taggedTemplateLiteral(["\n      <style include=\"shared-styles\">\n        :host {\n          display: block;\n\n          padding: 10px;\n        }\n\n        .filter-side {\n          position:absolute;\n          top : 120px;\n          right :70px;\n        }\n        \n        #cekData {\n          display :none;\n        }\n        #pages {\n          display: flex;\n          flex-wrap: wrap;\n          margin: 20px;\n        }\n\n        .search {\n          margin-bottom :20px;\n        }\n\n        #pages > button {\n          user-select: none;\n          padding: 5px;\n          margin: 0 5px;\n          border-radius: 100px;\n          border: 0;\n          background: transparent;\n          font: inherit;\n          outline: none;\n          cursor: pointer;\n        }\n\n        #pages > button:not([disabled]):hover,\n        #pages > button:focus {\n          color: #ccc;\n          background-color: #eee;\n        }\n\n        #pages > button[selected] {\n          font-weight: bold;\n          color: white;\n          background-color: #ccc;\n        }\n\n        #pages > button[disabled] {\n          opacity: 0.5;\n          cursor: default;\n        }\n        paper-button.green {\n          background-color: var(--paper-green-500);\n          color: white;\n        }\n        \n        paper-button.green[active] {\n          background-color: var(--paper-red-500);\n        }\n        vaadin-grid-cell-content{\n          overflow :unset;\n        }\n        vaadin-grid {\n          font-size :14px;\n        }\n\n        #main {\n          display :none;\n        }\n\n      </style>\n      <bmm-loader></bmm-loader>\n      <!-- app-location binds to the app's URL -->\n      <app-location route=\"{{route}}\"></app-location>\n\n      <!-- this app-route manages the top-level routes -->\n      <app-route\n          route=\"{{route}}\"\n          pattern=\"/panel/:view\"\n          data=\"{{routeData}}\"\n          tail=\"{{subroute}}\"></app-route>\n\n      <div class=\"card\" id=\"main\">\n        <h1>Data Muztahik</h1>\n        <iron-ajax\n          id=\"GetMuztahik\"\n          headers='{\"Access-Control-Allow-Origin\": \"*\" }'\n          handle-as=\"json\"\n          method=\"GET\"\n          on-response=\"_handleResponseM\"\n          on-error=\"_handleErrorM\"\n          Content-Type=\"application/json\"\n          debounce-duration=\"300\"></iron-ajax>\n        \n        <!-- ajax delete -->\n          <iron-ajax\n          id=\"DeleteMuztahik\"\n          headers='{\"Access-Control-Allow-Origin\": \"*\" }'\n          handle-as=\"json\"\n          method=\"DELETE\"\n          on-response=\"_handleMuztahikDelete\"\n          on-error=\"_handleMuztahikDeleteError\"\n          Content-Type=\"application/json\"\n          debounce-duration=\"300\"></iron-ajax>\n\n          <global-variable key=\"LoginCred\" \n              value=\"{{ storedUser }}\">\n          </global-variable>\n          <global-variable key=\"error\" \n              value=\"{{ error }}\">\n          </global-variable>\n          <global-data id=\"globalData\">\n          </global-data>\n      \n        <!-- Filter  -->\n        <div class=\"filter-side\">\n          <paper-menu-button on-iron-select=\"_itemSelected\">\n          <paper-icon-button icon=\"search\" slot=\"dropdown-trigger\">   </paper-icon-button>\n              <paper-listbox slot=\"dropdown-content\">\n                <dom-repeat items=\"{{filter}}\" id=\"dropdownArray\" selected=\"1\">\n                  <template>\n                      <paper-item >{{item}}</paper-item>\n                  </template>\n                </dom-repeat>\n                </paper-listbox>\n          \n          </paper-menu-button>\n          <paper-button  raised class=\"green\" on-click=\"_addMuztahik\" id=\"addMuztahik\">Tambah</paper-button>\n        </div>\n\n        <div class=\"search\">\n            <dom-repeat items=\"{{selectedArray}}\" id=\"selectedField\">\n              <template>\n              <vaadin-text-field label=\"{{item.name}}\"  value=\"{{item.value}}\"></vaadin-text-field>\n              <paper-icon-button icon=\"remove\" id=\"{{item.name}}\" on-click=\"_removeArray\"> Filter  </paper-icon-button>\n              </template>\n            </dom-repeat>\n            <paper-button  raised class=\"indigo\" on-click=\"cekData\" id=\"cekData\">Search</paper-button>\n        </div>\n          \n        <!-- End Filter -->\n          <!-- Table  -->\n          <vaadin-grid theme=\"column-borders\" column-reordering-allowed multi-sort id=\"grid\" page-size=\"10\" height-by-rows aria-label=\"Selection using Active Item Example\" >\n            <vaadin-grid-sort-column path=\"nama\" id=\"nama\" width=\"200px\"></vaadin-grid-sort-column >\n              <vaadin-grid-sort-column path=\"nik\" width=\"150px\"></vaadin-grid-sort-column >\n              <vaadin-grid-sort-column  path=\"kecamatan\" width=\"140px\"></vaadin-grid-sort-column >\n              <vaadin-grid-sort-column path=\"kabkot\" header=\"Kabupaten/Kota\" width=\"140px\"></vaadin-grid-sort-column >\n              <vaadin-grid-sort-column path=\"provinsi\" width=\"140px\"></vaadin-grid-sort-column >\n              <vaadin-grid-column header=\"Action\" id=\"action\"></vaadin-grid-column>\n          </vaadin-grid>\n          <div id=\"pages\"></div>\n          <!-- End Table -->\n      </div>\n    "]);_templateObject_39736430a3c111e9ab8d3bc52ff0ef99=function _templateObject_39736430a3c111e9ab8d3bc52ff0ef99(){return data};return data}new Promise(function(res,rej){return _require.default(["../config/loader.js"],res,rej)}).then(function(bundle){return bundle&&bundle.$loader||{}});var Muzatahik=function(_PolymerElement){babelHelpers.inherits(Muzatahik,_PolymerElement);function Muzatahik(){babelHelpers.classCallCheck(this,Muzatahik);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(Muzatahik).apply(this,arguments))}babelHelpers.createClass(Muzatahik,[{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(babelHelpers.getPrototypeOf(Muzatahik.prototype),"connectedCallback",this).call(this);this._loading(1)}},{key:"_activatedChanged",value:function _activatedChanged(newValue,oldValue){if(newValue){localStorage.removeItem("register-data");this.getData(this.storeData)}}},{key:"_loading",value:function _loading(show){if(0==show){this.shadowRoot.querySelector("#main").style.display="block";var that=this;setTimeout(function(){that.shadowRoot.querySelector("bmm-loader").style.display="none"},2e3)}else{this.shadowRoot.querySelector("#main").style.display="none";this.shadowRoot.querySelector("bmm-loader").style.display="block"}}},{key:"_clicked",value:function _clicked(){var action=this.$.action,that=this;action.renderer=function(root,column,rowData){root.innerHTML="<paper-button class=\"green\">Lihat</paper-button><paper-icon-button icon =\"add\" class=\"green\">Add</paper-icon-button>";root.childNodes[0].addEventListener("click",function(e){that.set("subroute.path","/profile-muztahik/"+rowData.item._id)});root.childNodes[1].addEventListener("click",function(e){that.set("route.path","/panel/proposal/add-proposal/"+rowData.item._id)})}}},{key:"_addMuztahik",value:function _addMuztahik(){this.set("subroute.path","/add-muztahik")}},{key:"_showArray",value:function _showArray(){var value;if(0<this.selectedArray.length){value="inline"}else{value="none";this.getData(this.storedUser)}this.$.cekData.updateStyles({display:value})}},{key:"_removeArray",value:function _removeArray(obj){for(var name=obj.target.id,i=0;i<this.selectedArray.length;i++){if(this.selectedArray[i].name==name){this.selectedArray.splice(i,1)}}this.filter.push(name);this.$.selectedField.render();this.$.dropdownArray.render();this._showArray()}},{key:"_containsObject",value:function _containsObject(obj,list){for(var i=0;i<list.length;i++){if(list[i].name===obj){return!0}}return!1}},{key:"_itemSelected",value:function _itemSelected(e){var selected=e.target.selectedItem.innerText;if(this._containsObject(this.selectereArray,selected)){this.selectedArray.push({name:selected,value:""});this.filter=this.filter.filter(function(value,index,arr){return value!=selected})}this.$.selectedField.render();this._showArray()}},{key:"getData",value:function getData(storeData){var url=1<arguments.length&&arguments[1]!==void 0?arguments[1]:MyAppGlobals.apiPath+"/api/muztahiks";this.$.GetMuztahik.url=url;this.$.GetMuztahik.headers.authorization=this.storedUser.access_token;this.$.GetMuztahik.generateRequest()}},{key:"cekData",value:function cekData(){this.pages=0;var pagesControl=this.$.pages;pagesControl.innerHTML="";var search="?";this.selectedArray.forEach(function(item){search+=2<search.length?"&":"";search+="nik"==item.name?"nik_no_yayasan"+"="+item.value:item.name+"="+item.value});var url=MyAppGlobals.apiPath+"/api/muztahiks"+search;this.getData(this.storedUser,url)}},{key:"_handleResponseM",value:function _handleResponseM(event){var response=event.detail.response;this.muztahiks=response.data;var grid=this.$.grid;grid.items=this.muztahiks;this._clicked();this.updateItemsFromPage(1)}},{key:"_handleErrorM",value:function _handleErrorM(e){this.error=e.detail.request.xhr.status}},{key:"updateItemsFromPage",value:function updateItemsFromPage(page){if(null!==this.muztahiks){var pagesControl=this.$.pages,that=this,grid=this.$.grid;if(page===void 0){return}if(!that.pages){that.pages=Array.apply(null,{length:Math.ceil(this.muztahiks.length/grid.pageSize)}).map(function(item,index){return index+1});var prevBtn=window.document.createElement("button");prevBtn.classList.add("navigation-page");prevBtn.textContent="previous";prevBtn.addEventListener("click",function(){var selectedPage=parseInt(pagesControl.querySelector("[selected]").textContent);that.updateItemsFromPage(selectedPage-1)});pagesControl.appendChild(prevBtn);that.pages.forEach(function(pageNumber){var pageBtn=window.document.createElement("button");pageBtn.classList.add("navigation-page");pageBtn.textContent=pageNumber;pageBtn.addEventListener("click",function(e){that.updateItemsFromPage(parseInt(e.target.textContent))});if(pageNumber===page){pageBtn.setAttribute("selected",!0)}pagesControl.appendChild(pageBtn)});var nextBtn=window.document.createElement("button");nextBtn.classList.add("navigation-page-number");nextBtn.textContent="next";nextBtn.addEventListener("click",function(){var selectedPage=parseInt(pagesControl.querySelector("[selected]").textContent);that.updateItemsFromPage(selectedPage+1)});pagesControl.appendChild(nextBtn)}var buttons=Array.from(pagesControl.children);buttons.forEach(function(btn,index){if(parseInt(btn.textContent)===page){btn.setAttribute("selected",!0)}else{btn.removeAttribute("selected")}if(0===index){if(1===page){btn.setAttribute("disabled","")}else{btn.removeAttribute("disabled")}}if(index===buttons.length-1){if(page===that.pages.length){btn.setAttribute("disabled","")}else{btn.removeAttribute("disabled")}}});var start=(page-1)*grid.pageSize,end=page*grid.pageSize;grid.items=this.muztahiks.slice(start,end);this._clicked();this._loading(0)}}},{key:"_handleMuztahikDelete",value:function _handleMuztahikDelete(e){this.getData(this.storeDatagetData)}},{key:"_handleMuztahikDeleteError",value:function _handleMuztahikDeleteError(e){console.log(e)}}],[{key:"template",get:function get(){return(0,_myApp.html)(_templateObject_39736430a3c111e9ab8d3bc52ff0ef99())}},{key:"properties",get:function get(){return{muztahiks:{type:Array,notify:!0},Search:String,storedUser:{type:Object,notify:!0},filter:{type:Array,notify:!0,value:function value(){return["nama","nik","alamat","kecamatan","kabkot","provinsi"]}},selectedArray:{type:Array,notify:!0,value:function value(){return[]}},datacuk:{type:Boolean,value:!0},pages:{type:Array,notify:!0},incre:{type:Number,value:0},activated:{type:Boolean,value:!1,observer:"_activatedChanged"},showLoader:{type:Number,notify:!0,value:0}}}},{key:"observers",get:function get(){return[]}}]);return Muzatahik}(_myApp.PolymerElement);window.customElements.define("bmm-muztahik",Muzatahik)});